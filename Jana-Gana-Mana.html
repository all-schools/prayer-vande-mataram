<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Prayer</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px;
            margin: 0;
        }
        .container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-bottom: 5px solid #000;
            margin-bottom: 20px;
            padding-bottom: 20px;
        }
        .header-title {
            text-align: center;
            font-weight: bold;
            font-size: 24px;
            margin: 20px 0;
        }
        .lyrics {
            padding: 0 20px;
            line-height: 1.6;
            font-size: 16px;
            color: #333;
            font-weight: 500;
        }
        .player-card {
            background-color: #fff5f5;
            margin: 15px 20px;
            padding: 10px;
            border-radius: 5px;
        }
        .progress-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-family: monospace;
            font-size: 14px;
        }
        input[type="range"] {
            flex-grow: 1;
            margin: 0 10px;
            cursor: pointer;
        }
        .button-group {
            display: flex;
            justify-content: space-around;
            padding: 0 10px;
        }
        .btn {
            background: #808080; 
            color: white;
            border: 2px solid #555;
            border-radius: 25px;
            padding: 8px 0;
            width: 30%;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }
        .btn.downloaded {
            background: #28a745 !important;
            border-color: #1e7e34;
        }
        .btn:active {
            transform: translateY(2px);
        }
        .lyrics-part { display: none; }
        .lyrics-part.active { display: block; }
    </style>
</head>
<body>

    <div class="header-title" id="main-title"> জন গণ মন</div>
    <div id="stanza-container"></div>

    <script>
        const musicData = {
            1: { 
                clip: 'https://www.dropbox.com/scl/fi/miroq6t0adphrffmc0vr8/JanaGanaManaPart1Clip.mp3?rlkey=rs80x8ah0mokohrzc1xrggjxx&st=hqu8uw3t&raw=1', 
                segment: 'https://www.dropbox.com/scl/fi/miroq6t0adphrffmc0vr8/JanaGanaManaPart1Clip.mp3?rlkey=rs80x8ah0mokohrzc1xrggjxx&st=hqu8uw3t&raw=1',
                full: 'https://www.dropbox.com/scl/fi/kztd232jbhafj8uuatwfm/JanaGanaMana.mp3?rlkey=zlb8s6js63vngxie4gkuh1k19&st=qnmqh1dn&raw=1' 
            },
            2: { 
                clip: 'https://www.dropbox.com/scl/fi/6embcip3uuew8nbadaha5/JanaGanaManaPart2Clip.mp3?rlkey=3cjj6v1xzlfivb5mcu78xc37c&st=z4y5shh3&raw=1', 
                segment: 'https://www.dropbox.com/scl/fi/mk4s6ih2dyae5993s2tsd/JanaGanaManaPart2Segment.mp3?rlkey=fu55osmmzxyrcpxkbwwuhdf0a&st=fr3134wi&raw=1', 
                full: 'https://www.dropbox.com/scl/fi/kztd232jbhafj8uuatwfm/JanaGanaMana.mp3?rlkey=zlb8s6js63vngxie4gkuh1k19&st=qnmqh1dn&raw=1' 
            },
            3: { 
                clip: 'https://www.dropbox.com/scl/fi/1qyzwkveqcshfjs6urfe8/JanaGanaManaPart3Clip.mp3?rlkey=cerqs3m3eh7xv6n42zos6o7jf&st=bfp0dqsj&raw=1', 
                segment: 'https://www.dropbox.com/scl/fi/5fqv5smy47r01kaazc99l/JanaGanaManaPart3Segment.mp3?rlkey=nn0uq6qtd98hdcs2682g7udws&st=izg9p4k6&raw=1', 
                full: 'https://www.dropbox.com/scl/fi/kztd232jbhafj8uuatwfm/JanaGanaMana.mp3?rlkey=zlb8s6js63vngxie4gkuh1k19&st=qnmqh1dn&raw=1' },

            4: { 
                clip: 'https://www.dropbox.com/scl/fi/67jwvt8h7of8ko4vr4sxx/JanaGanaManaPart4Clip.mp3?rlkey=xlhjerldo8eunamig5uz8qxbm&st=xldlc1r7&raw=1', 
                segment: 'https://www.dropbox.com/scl/fi/x9gsg1z7fjormnpy18ljh/JanaGanaManaPart4Segment.mp3?rlkey=87q5avqm8q72zlnw1zsatif16&st=k3fboe2j&raw=1', 
                full: 'https://www.dropbox.com/scl/fi/kztd232jbhafj8uuatwfm/JanaGanaMana.mp3?rlkey=zlb8s6js63vngxie4gkuh1k19&st=qnmqh1dn&raw=1' },

            5: { 
                clip: 'https://www.dropbox.com/scl/fi/jgb6hh46lykeaibs89wjc/JanaGanaManaPart5Clip.mp3?rlkey=wulvmfxsynsxnpjaljpism77m&st=810n2jfh&raw=1', 
                segment: 'https://www.dropbox.com/scl/fi/zdn1xljgori70lmbg21gi/JanaGanaManaPart5Segment.mp3?rlkey=u40cg0xn04fnn20wca1o1best&st=4n60vtpf&raw=1', 
                full: 'https://www.dropbox.com/scl/fi/kztd232jbhafj8uuatwfm/JanaGanaMana.mp3?rlkey=zlb8s6js63vngxie4gkuh1k19&st=qnmqh1dn&raw=1' },

            6: { 
                clip: 'https://www.dropbox.com/scl/fi/banjwmzo15jupqu3vkb1s/JanaGanaManaPart6Clip.mp3?rlkey=h045govcofudef8du5eah3txg&st=rcoz2mo3&raw=1', 
                segment: 'https://www.dropbox.com/scl/fi/uzc3nw1qzci1r4u9op6ov/JanaGanaManaPart6Segment.mp3?rlkey=uozhi1xqzhgtx4t01tkuyrvv3&st=y9wdo2eu&raw=1', 
                full: 'https://www.dropbox.com/scl/fi/kztd232jbhafj8uuatwfm/JanaGanaMana.mp3?rlkey=zlb8s6js63vngxie4gkuh1k19&st=qnmqh1dn&raw=1' }
        };

        const stanzas = [ { text: " <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <br> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <br> জনগণমঙ্গলদায়ক জয় হে ভারতভাগ্যবিধাতা! <br> জয় হে, জয় হে, জয় হে, জয় জয় জয় জয় হে॥ <hr> ", id: 1 }, { text: " <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <hr> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <br> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <br> জনগণমঙ্গলদায়ক জয় হে ভারতভাগ্যবিধাতা! <br> জয় হে, জয় হে, জয় হে, জয় জয় জয় জয় হে॥ <hr> ", id: 2 }, { text: " <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <hr> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <br> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <br> জনগণমঙ্গলদায়ক জয় হে ভারতভাগ্যবিধাতা! <br> জয় হে, জয় হে, জয় হে, জয় জয় জয় জয় হে॥ <hr> ", id: 3 }, { text: " <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <br> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <hr> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <br> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <br> জনগণমঙ্গলদায়ক জয় হে ভারতভাগ্যবিধাতা! <br> জয় হে, জয় হে, জয় হে, জয় জয় জয় জয় হে॥ <hr> ", id: 4}, { text: " <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <br> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <br> জনগণমঙ্গলদায়ক জয় হে ভারতভাগ্যবিধাতা! <hr> জনগণমঙ্গলদায়ক জয় হে ভারতভাগ্যবিধাতা! <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <br> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <br> জনগণমঙ্গলদায়ক জয় হে ভারতভাগ্যবিধাতা! <br> জয় হে, জয় হে, জয় হে, জয় জয় জয় জয় হে॥ <hr> ", id: 5}, { text: " <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <br> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <br> জনগণমঙ্গলদায়ক জয় হে ভারতভাগ্যবিধাতা! <br> জয় হে, জয় হে, জয় হে, জয় জয় জয় জয় হে॥ <hr> জয় হে, জয় হে, জয় হে, জয় জয় জয় জয় হে॥ <hr> জনগণমন-অধিনায়ক জয় হে ভারতভাগ্যবিধাতা! <br> পঞ্জাব সিন্ধু গুজরাট মরাঠা দ্রাবিড় উৎকল বঙ্গ <br> বিন্ধ্য হিমাচল যমুনা গঙ্গা উচ্ছলজলধিতরঙ্গ <br> তব শুভ নামে জাগে, <br> তব শুভ আশিষ মাগে, <br> গাহে তব জয়গাথা। <br> জনগণমঙ্গলদায়ক জয় হে ভারতভাগ্যবিধাতা! <br> জয় হে, জয় হে, জয় হে, জয় জয় জয় জয় হে॥ <hr> ", id: 6} ];

        const container = document.getElementById('stanza-container');
        let activeAudio = null;

        function processLyrics(htmlText, id) {
            const parts = htmlText.split('<hr>');
            const actualParts = parts.filter(p => p.trim() !== "");
            return `
                <div id="part-segment-${id}" class="lyrics-part">${actualParts[0]}</div>
                <div id="part-clip-${id}" class="lyrics-part active">${actualParts[1]}</div>
                <div id="part-full-${id}" class="lyrics-part">${actualParts[2]}</div>
            `;
        }

        for (let i = 1; i <= 6; i++) {
            const section = document.createElement('div');
            section.className = 'container';
            section.id = `container-${i}`;
            section.innerHTML = `
                <div class="lyrics">${processLyrics(stanzas[i-1].text, i)}</div>
                <div class="player-card">
                    <div class="progress-container">
                        <span id="current-time-${i}">0:00</span>
                        <input type="range" id="progress-${i}" value="0" min="0" max="100" oninput="seekAudio(${i})">
                        <span id="duration-${i}">0:00</span>
                    </div>
                </div>
                <div class="button-group" id="btn-group-${i}">
                    <button class="btn" id="btn-clip-${i}">Loading...</button>
                    <button class="btn" id="btn-segment-${i}">Loading...</button>
                    <button class="btn" id="btn-full-${i}">Loading...</button>
                </div>
                <audio id="audio-${i}" preload="auto"></audio>
            `;
            container.appendChild(section);
            setupAudioEvents(i);
            preloadStanza(i);
        }

        function setupAudioEvents(id) {
            const audio = document.getElementById(`audio-${id}`);
            const progress = document.getElementById(`progress-${id}`);
            const curTimeTxt = document.getElementById(`current-time-${id}`);
            const durTimeTxt = document.getElementById(`duration-${id}`);

            audio.ontimeupdate = () => {
                const val = (audio.currentTime / audio.duration) * 100;
                progress.value = val || 0;
                curTimeTxt.innerText = formatTime(audio.currentTime);
                durTimeTxt.innerText = formatTime(audio.duration);
            };

            audio.onended = () => {
                // গানের শেষে এখন আর resetUI কল হবে না
                const btnClip = document.getElementById(`btn-clip-${id}`);
                btnClip.innerText = "Play";
            };
        }

        function preloadStanza(id) {
            const btnClip = document.getElementById(`btn-clip-${id}`);
            const btnSeg = document.getElementById(`btn-segment-${id}`);
            const btnFull = document.getElementById(`btn-full-${id}`);
            
            let clipReady = false, segmentReady = false, fullReady = false;

            const checkAllReady = () => {
                if (clipReady && segmentReady && fullReady) {
                    btnClip.innerText = "Clip";
                    btnClip.onclick = () => playSong(id, 'clip');
                    btnSeg.innerText = "Segment";
                    btnSeg.onclick = () => playSong(id, 'segment');
                    btnFull.innerText = "Full Song";
                    btnFull.onclick = () => playSong(id, 'full');

                    btnClip.classList.add('downloaded');
                    btnSeg.classList.add('downloaded');
                    btnFull.classList.add('downloaded');
                }
            };

            const a1 = new Audio(musicData[id].clip);
            const a2 = new Audio(musicData[id].segment);
            const a3 = new Audio(musicData[id].full);

            a1.oncanplaythrough = () => { clipReady = true; checkAllReady(); };
            a2.oncanplaythrough = () => { segmentReady = true; checkAllReady(); };
            a3.oncanplaythrough = () => { fullReady = true; checkAllReady(); };
        }

        function playSong(id, type) {
            const audio = document.getElementById(`audio-${id}`);
            const btnClip = document.getElementById(`btn-clip-${id}`);

            document.querySelectorAll('.container').forEach(c => c.style.display = 'none');
            document.getElementById(`container-${id}`).style.display = 'block';
            document.getElementById('main-title').style.display = 'none';

            document.querySelectorAll(`#container-${id} .lyrics-part`).forEach(p => p.classList.remove('active'));
            document.getElementById(`part-${type}-${id}`).classList.add('active');

            if (activeAudio === audio && audio.dataset.currentType === type) {
                if (!audio.paused) {
                    audio.pause();
                    btnClip.innerText = "Play";
                } else {
                    audio.play();
                    btnClip.innerText = "Pause";
                }
                return;
            }

            if (activeAudio && activeAudio !== audio) {
                const prevId = activeAudio.id.split('-')[1];
                stopAndResetButtons(prevId);
            }

            audio.src = musicData[id][type];
            audio.dataset.currentType = type;
            activeAudio = audio;
            audio.play();

            updateControls(id);
        }

        function updateControls(id) {
            const audio = document.getElementById(`audio-${id}`);
            const btnClip = document.getElementById(`btn-clip-${id}`);
            const btnSeg = document.getElementById(`btn-segment-${id}`);
            const btnFull = document.getElementById(`btn-full-${id}`);

            btnClip.innerText = "Pause";
            btnClip.onclick = () => {
                if (audio.paused) {
                    audio.play();
                    btnClip.innerText = "Pause";
                } else {
                    audio.pause();
                    btnClip.innerText = "Play";
                }
            };

            btnSeg.innerText = "Reset";
            btnSeg.onclick = () => resetUI(id);

            btnFull.innerText = "Replay";
            btnFull.onclick = () => {
                audio.currentTime = 0;
                audio.play();
                btnClip.innerText = "Pause";
            };
        }

        // এটি কেবল অন্য স্ট্যাঞ্জা প্লে করার সময় আগেরটিকে থামানোর জন্য
        function stopAndResetButtons(id) {
            const audio = document.getElementById(`audio-${id}`);
            audio.pause();
            audio.currentTime = 0;
            
            const btnClip = document.getElementById(`btn-clip-${id}`);
            const btnSeg = document.getElementById(`btn-segment-${id}`);
            const btnFull = document.getElementById(`btn-full-${id}`);
            
            btnClip.innerText = "Clip";
            btnClip.onclick = () => playSong(id, 'clip');
            btnSeg.innerText = "Segment";
            btnSeg.onclick = () => playSong(id, 'segment');
            btnFull.innerText = "Full Song";
            btnFull.onclick = () => playSong(id, 'full');
        }

        function resetUI(id) {
            const audio = document.getElementById(`audio-${id}`);
            audio.pause();
            audio.currentTime = 0;
            audio.dataset.currentType = "";
            activeAudio = null;

            document.querySelectorAll('.container').forEach(c => c.style.display = 'block');
            document.getElementById('main-title').style.display = 'block';

            document.querySelectorAll('.lyrics-part').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('[id^="part-clip-"]').forEach(p => p.classList.add('active'));

            const btnClip = document.getElementById(`btn-clip-${id}`);
            const btnSeg = document.getElementById(`btn-segment-${id}`);
            const btnFull = document.getElementById(`btn-full-${id}`);
            
            btnClip.innerText = "Clip";
            btnClip.onclick = () => playSong(id, 'clip');
            
            btnSeg.innerText = "Segment";
            btnSeg.onclick = () => playSong(id, 'segment');
            
            btnFull.innerText = "Full Song";
            btnFull.onclick = () => playSong(id, 'full');

            document.getElementById(`current-time-${id}`).innerText = "0:00";
            document.getElementById(`progress-${id}`).value = 0;
        }

        function formatTime(seconds) {
            if (isNaN(seconds)) return "0:00";
            let min = Math.floor(seconds / 60);
            let sec = Math.floor(seconds % 60);
            return `${min}:${sec < 10 ? '0' + sec : sec}`;
        }

        function seekAudio(id) {
            const audio = document.getElementById(`audio-${id}`);
            const progress = document.getElementById(`progress-${id}`);
            if (audio.duration) {
                audio.currentTime = (progress.value / 100) * audio.duration;
            }
        }
    </script>
</body>
</html>
